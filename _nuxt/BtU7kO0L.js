const __vite__fileDeps=["./BDhG-Ffe.js","./DGn-Ul8E.js","./entry.BmTm8ZvO.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{ag as v,ah as w,ai as P,aj as E,r as U}from"./DGn-Ul8E.js";const L=["Elektronika","Odzież","Obuwie","Kosmetyki","Żywność","Kultura","Sport","Zdrowie","Hobby","Transport","Dom","Dzieci","Zwierzęta","Akcesoria","Opłaty","Motoryzacja","Zachcianki","Inne"],R=()=>({billCategories:L});var d;(function(i){i.Prompt="PROMPT",i.Camera="CAMERA",i.Photos="PHOTOS"})(d||(d={}));var u;(function(i){i.Rear="REAR",i.Front="FRONT"})(u||(u={}));var m;(function(i){i.Uri="uri",i.Base64="base64",i.DataUrl="dataUrl"})(m||(m={}));class g extends v{async getPhoto(a){return new Promise(async(n,r)=>{if(a.webUseInput||a.source===d.Photos)this.fileInputExperience(a,n,r);else if(a.source===d.Prompt){let t=document.querySelector("pwa-action-sheet");t||(t=document.createElement("pwa-action-sheet"),document.body.appendChild(t)),t.header=a.promptLabelHeader||"Photo",t.cancelable=!1,t.options=[{title:a.promptLabelPhoto||"From Photos"},{title:a.promptLabelPicture||"Take Picture"}],t.addEventListener("onSelection",async o=>{o.detail===0?this.fileInputExperience(a,n,r):this.cameraExperience(a,n,r)})}else this.cameraExperience(a,n,r)})}async pickImages(a){return new Promise(async(n,r)=>{this.multipleFileInputExperience(n,r)})}async cameraExperience(a,n,r){if(customElements.get("pwa-camera-modal")){const t=document.createElement("pwa-camera-modal");t.facingMode=a.direction===u.Front?"user":"environment",document.body.appendChild(t);try{await t.componentOnReady(),t.addEventListener("onPhoto",async o=>{const s=o.detail;s===null?r(new w("User cancelled photos app")):s instanceof Error?r(s):n(await this._getCameraPhoto(s,a)),t.dismiss(),document.body.removeChild(t)}),t.present()}catch{this.fileInputExperience(a,n,r)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(a,n,r)}fileInputExperience(a,n,r){let t=document.querySelector("#_capacitor-camera-input");const o=()=>{var s;(s=t.parentNode)===null||s===void 0||s.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input",t.type="file",t.hidden=!0,document.body.appendChild(t),t.addEventListener("change",s=>{const e=t.files[0];let c="jpeg";if(e.type==="image/png"?c="png":e.type==="image/gif"&&(c="gif"),a.resultType==="dataUrl"||a.resultType==="base64"){const l=new FileReader;l.addEventListener("load",()=>{if(a.resultType==="dataUrl")n({dataUrl:l.result,format:c});else if(a.resultType==="base64"){const p=l.result.split(",")[1];n({base64String:p,format:c})}o()}),l.readAsDataURL(e)}else n({webPath:URL.createObjectURL(e),format:c}),o()}),t.addEventListener("cancel",s=>{r(new w("User cancelled photos app")),o()})),t.accept="image/*",t.capture=!0,a.source===d.Photos||a.source===d.Prompt?t.removeAttribute("capture"):a.direction===u.Front?t.capture="user":a.direction===u.Rear&&(t.capture="environment"),t.click()}multipleFileInputExperience(a,n){let r=document.querySelector("#_capacitor-camera-input-multiple");const t=()=>{var o;(o=r.parentNode)===null||o===void 0||o.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input-multiple",r.type="file",r.hidden=!0,r.multiple=!0,document.body.appendChild(r),r.addEventListener("change",o=>{const s=[];for(let e=0;e<r.files.length;e++){const c=r.files[e];let l="jpeg";c.type==="image/png"?l="png":c.type==="image/gif"&&(l="gif"),s.push({webPath:URL.createObjectURL(c),format:l})}a({photos:s}),t()}),r.addEventListener("cancel",o=>{n(new w("User cancelled photos app")),t()})),r.accept="image/*",r.click()}_getCameraPhoto(a,n){return new Promise((r,t)=>{const o=new FileReader,s=a.type.split("/")[1];n.resultType==="uri"?r({webPath:URL.createObjectURL(a),format:s,saved:!1}):(o.readAsDataURL(a),o.onloadend=()=>{const e=o.result;n.resultType==="dataUrl"?r({dataUrl:e,format:s,saved:!1}):r({base64String:e.split(",")[1],format:s,saved:!1})},o.onerror=e=>{t(e)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}new g;const f=P("Camera",{web:()=>new g}),b=P("Preferences",{web:()=>E(()=>import("./BDhG-Ffe.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(i=>new i.PreferencesWeb)}),y="photos",O=()=>{const i=U([]),a=async()=>{const{value:e}=await b.get({key:y}),c=(e?JSON.parse(e):[])||[];c.forEach(l=>{i.value.some(h=>h.filepath===l.filepath)||i.value.unshift(l)}),i.value=c},n=async()=>{try{return await f.getPhoto({quality:80,allowEditing:!1,resultType:m.DataUrl,source:d.Photos,width:600,correctOrientation:!0})}catch(e){console.error("Error selecting photo",e)}},r=async()=>{const e=await f.getPhoto({resultType:m.DataUrl,source:d.Camera,quality:80,width:600,correctOrientation:!0});if(e&&e.dataUrl){const c=await s(e);return i.value=[c,...i.value],await b.set({key:y,value:JSON.stringify(i.value)}),{webviewPath:e.dataUrl,...e}}else return console.warn("Nie udało się pobrać zdjęcia."),null},t=async()=>{try{const e=await r();if(e&&e.webviewPath)return i.value=[],i.value.push({webviewPath:e.webviewPath,document:document.value}),{pb64:e.dataUrl.split(",")[1],doc:{title:"New Photo",description:"Photo taken with the app",timestamp:new Date}};console.warn("Nieprawidłowe zdjęcie zwrócone lub zdjęcie zostało anulowane.")}catch(e){console.error("Error adding photo",e)}},o=async()=>{try{const e=await n();if(e&&e.dataUrl)return i.value=[],i.value.push({webviewPath:e.dataUrl,document:document.value}),{pb64:e.dataUrl.split(",")[1],doc:{title:"New Photo",description:"Photo taken with the app",timestamp:new Date}};console.warn("Nieprawidłowe zdjęcie zwrócone lub zdjęcie zostało anulowane.")}catch(e){console.error("Error selecting photo",e)}},s=async e=>{const c=await fetch(e.webPath).then(p=>p.blob()),l=new FileReader;return l.readAsDataURL(c),new Promise((p,h)=>{l.onloadend=()=>{p({filepath:new Date().getTime()+".jpeg",webviewPath:e.webPath})},l.onerror=h})};return{photos:i,loadSaved:a,photoFromCamera:t,selectPhotoFromData:o}};export{R as a,O as u};
